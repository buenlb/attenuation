function pulkkinen = bonePropertiesPulkkinen2014(createFigFlag,freq,beta,freq2)
% Pulkkinen 2014

connor = bonePropertiesConnor2002(createFigFlag);

pulkkinen.hu = connor.hu;
pulkkinen.rho = connor.rho;

% used WebPlotDigitizer (https://automeris.io/WebPlotDigitizer) to grab the values from figure 3
rho = [1203.301887, 1238.79717, 1274.292453, 1296.580189, 1327.948113, 1375.825472, 1433.608491, 1486.438679, 1544.221698, 1595.400943, 1639.976415, 1712.617925, 1821.580189, 1915.683962, 1998.231132, 2075.825472, 2164.976415, 2270.636792, 2351.533019, 2450.589623, 2599.174528];
atten = [1.994018059, 1.817042889, 1.666930023, 1.580022573, 1.482054176, 1.374604966, 1.308239278, 1.301918736, 1.336681716, 1.391986456, 1.447291196, 1.545259594, 1.693792325, 1.823363431, 1.937133183, 2.03510158, 2.129909707, 2.221557562, 2.278442438, 2.329006772, 2.385891648];
pulkkinen.atten = interp1(rho, atten, pulkkinen.rho);

rho = [1204.6; 1219.5; 1234.3; 1249.2; 1264.1; 1279; 1293.8; 1308.7; 1323.6; 1338.4; 1353.3; 1368.2; 1383; 1397.9; 1412.8; 1427.6; 1442.5; 1457.4; 1472.2; 1487.1; 1502; 1516.8; 1531.7; 1546.6; 1561.4; 1576.3; 1591.1; 1606; 1620.9; 1635.7; 1650.6; 1665.5; 1680.3; 1695.2; 1710; 1724.9; 1739.8; 1754.6; 1769.5; 1784.4; 1799.2; 1814.1; 1828.9; 1843.8; 1858.7; 1873.5; 1888.4; 1903.3; 1918.1; 1933; 1948.3; 1962.7; 1977.6; 1992.4; 2007.3; 2022.2; 2037; 2051.9; 2066.8; 2081.6; 2096.5; 2111.4; 2126.2; 2141.1; 2156; 2170.8; 2185.7; 2200.6; 2215.4; 2230.3; 2245.2; 2260; 2274.9; 2289.8; 2304.7; 2319.5; 2334.4; 2349.3; 2364.1; 2379; 2393.9; 2408.7; 2423.6; 2438.5; 2453.4; 2468.2; 2483.1; 2498; 2512.8; 2527.7; 2542.6; 2557.5; 2572.3; 2587.2];
c = [1801.8; 1818.6; 1845; 1872; 1899.1; 1923.5; 1949.8; 1972.1; 1997.2; 2018.8; 2041.6; 2061.9; 2080.7; 2099.3; 2115.1; 2132.9; 2146.7; 2162.7; 2173.3; 2186.6; 2194.6; 2206.1; 2214.9; 2222.4; 2230.5; 2236.2; 2240; 2247.8; 2251; 2260.3; 2262.1; 2267.3; 2267.6; 2277.4; 2278.6; 2288.4; 2291.2; 2295.2; 2302.2; 2307; 2314.5; 2321.3; 2327.8; 2336.1; 2342.3; 2352.4; 2362.1; 2368.2; 2381.7; 2390.7; 2401.7; 2412.6; 2423.6; 2436.4; 2447.7; 2461.7; 2475.3; 2490.3; 2502.4; 2520.2; 2535.5; 2550.8; 2567.3; 2584.1; 2600.2; 2619; 2639.1; 2655.6; 2673.9; 2693.5; 2713.3; 2733.6; 2753.9; 2775.3; 2796.6; 2817.6; 2840.2; 2862.8; 2888.1; 2911.2; 2935; 2959.1; 2984.2; 3011.3; 3037.1; 3063.2; 3091.5; 3118.6; 3146.2; 3174.6; 3200.9; 3231.5; 3259.1; 3286.9];
pulkkinen.c = interp1(rho, c, pulkkinen.rho);

rho = 1200:100:2600;

atten270 = [115.6, 96.4, 78.2, 61.1, 45.5, 32.0, 21.9, 17.3, 19.6, 29.3, 45.2, 65.5, 88.5, 112.5, 135.8];
atten836 = [249.4, 206.1, 185.9, 185.9, 197.4, 211.7, 225.1, 237.3, 248.0, 256.3, 261.3, 263.6, 264.0, 263.0, 261.5];
atten1402 = [422.7, 441.7, 448.0, 441.0, 421.6, 393.0, 358.2, 321.1, 287.8, 261.6, 242.3, 229.2, 222.0, 220.0, 222.7];

switch freq2
    case 270
        atten = atten270/100;
        freq0 = 0.27;
    case 836
        atten = atten836/100;
        freq0 = 0.836;
    case 1402
        atten = atten1402/100;
        freq0 = 1.402;
end

pulkkinen.atten = interp1(rho, atten, pulkkinen.rho);
pulkkinen.atten = pulkkinen.atten*(freq/freq0)^beta;

if createFigFlag
    figure; plot(pulkkinen.rho, pulkkinen.atten);
    xlabel('Density (kg/m^3)'); ylabel('Attenuation (Np/cm)');
    grid on;
    ylim([0 4]);
    figName = 'Pulkkinen 2014 attenuation vs density';
    title(figName);
    figPath = fullfile('C:/Users/Steve/Downloads', figName);
    exportFig(gcf, figPath, '-transparent');
end