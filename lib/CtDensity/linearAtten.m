% Return Values for mu for air, bone, and water based on a given energy
% 
% @INPUTS
%   energy: CT energy in MeV
% 
% @OUTPUTS
%   mu in m^2/kg
%   

function [muA, muW, muB] = linearAtten(energy)
% Bone
muBT = [1.00000E-03  3.781E+03  3.772E+03;...
       1.03542E-03  3.452E+03  3.444E+03;...
       1.07210E-03  3.150E+03  3.143E+03;...
       1.18283E-03  2.434E+03  2.429E+03;...
       1.30500E-03  1.873E+03  1.869E+03;...
       1.50000E-03  1.295E+03  1.291E+03;...
       2.00000E-03  5.869E+02  5.846E+02;...
       2.14550E-03  4.824E+02  4.803E+02;...
       2.30297E-03  5.916E+02  5.789E+02;...
       2.47200E-03  4.907E+02  4.805E+02;...
       3.00000E-03  2.958E+02  2.897E+02;...
       4.00000E-03  1.331E+02  1.303E+02;...
       4.03810E-03  1.296E+02  1.269E+02;...
       5.00000E-03  1.917E+02  1.757E+02;...
       6.00000E-03  1.171E+02  1.085E+02;...
       8.00000E-03  5.323E+01  4.987E+01;...
       1.00000E-02  2.851E+01  2.680E+01;...
       1.50000E-02  9.032E+00  8.388E+00;...
       2.00000E-02  4.001E+00  3.601E+00;...
       3.00000E-02  1.331E+00  1.070E+00;...
       4.00000E-02  6.655E-01  4.507E-01;...
       5.00000E-02  4.242E-01  2.336E-01;...
       6.00000E-02  3.148E-01  1.400E-01;...
       8.00000E-02  2.229E-01  6.896E-02;...
       1.00000E-01  1.855E-01  4.585E-02;...
       1.50000E-01  1.480E-01  3.183E-02;...
       2.00000E-01  1.309E-01  3.003E-02;...
       3.00000E-01  1.113E-01  3.032E-02;...
       4.00000E-01  9.908E-02  3.069E-02;...
       5.00000E-01  9.022E-02  3.073E-02;...
       6.00000E-01  8.332E-02  3.052E-02;...
       8.00000E-01  7.308E-02  2.973E-02;...
       1.00000E+00  6.566E-02  2.875E-02;...
       1.25000E+00  5.871E-02  2.745E-02;...
       1.50000E+00  5.346E-02  2.623E-02;...
       2.00000E+00  4.607E-02  2.421E-02;...
       3.00000E+00  3.745E-02  2.145E-02;...
       4.00000E+00  3.257E-02  1.975E-02;...
       5.00000E+00  2.946E-02  1.864E-02;...
       6.00000E+00  2.734E-02  1.788E-02;...
       8.00000E+00  2.467E-02  1.695E-02;...
       1.00000E+01  2.314E-02  1.644E-02;...
       1.50000E+01  2.132E-02  1.587E-02;... 
       2.00000E+01  2.068E-02  1.568E-02];
   
% Water
muWT = [1.00000E-03  4.078E+03  4.065E+03;...
        1.50000E-03  1.376E+03  1.372E+03;...
        2.00000E-03  6.173E+02  6.152E+02;...
        3.00000E-03  1.929E+02  1.917E+02;...
        4.00000E-03  8.278E+01  8.191E+01;...
        5.00000E-03  4.258E+01  4.188E+01;...
        6.00000E-03  2.464E+01  2.405E+01;...
        8.00000E-03  1.037E+01  9.915E+00;...
        1.00000E-02  5.329E+00  4.944E+00;...
        1.50000E-02  1.673E+00  1.374E+00;...
        2.00000E-02  8.096E-01  5.503E-01;...
        3.00000E-02  3.756E-01  1.557E-01;...
        4.00000E-02  2.683E-01  6.947E-02;...
        5.00000E-02  2.269E-01  4.223E-02;...
        6.00000E-02  2.059E-01  3.190E-02;...
        8.00000E-02  1.837E-01  2.597E-02;...
        1.00000E-01  1.707E-01  2.546E-02;...
        1.50000E-01  1.505E-01  2.764E-02;...
        2.00000E-01  1.370E-01  2.967E-02;...
        3.00000E-01  1.186E-01  3.192E-02;...
        4.00000E-01  1.061E-01  3.279E-02;...
        5.00000E-01  9.687E-02  3.299E-02;...
        6.00000E-01  8.956E-02  3.284E-02;...
        8.00000E-01  7.865E-02  3.206E-02;...
        1.00000E+00  7.072E-02  3.103E-02;...
        1.25000E+00  6.323E-02  2.965E-02;...
        1.50000E+00  5.754E-02  2.833E-02;...
        2.00000E+00  4.942E-02  2.608E-02;...
        3.00000E+00  3.969E-02  2.281E-02;...
        4.00000E+00  3.403E-02  2.066E-02;...
        5.00000E+00  3.031E-02  1.915E-02;...
        6.00000E+00  2.770E-02  1.806E-02;...
        8.00000E+00  2.429E-02  1.658E-02;...
        1.00000E+01  2.219E-02  1.566E-02;...
        1.50000E+01  1.941E-02  1.441E-02;...
        2.00000E+01  1.813E-02  1.382E-02];
    
% Air
muAT = [1.00000E-03  3.606E+03  3.599E+03;...
       1.50000E-03  1.191E+03  1.188E+03;...
       2.00000E-03  5.279E+02  5.262E+02;...
       3.00000E-03  1.625E+02  1.614E+02;...
       3.20290E-03  1.340E+02  1.330E+02;...
       4.00000E-03  7.788E+01  7.636E+01;...
       5.00000E-03  4.027E+01  3.931E+01;...
       6.00000E-03  2.341E+01  2.270E+01;...
       8.00000E-03  9.921E+00  9.446E+00;...
       1.00000E-02  5.120E+00  4.742E+00;...
       1.50000E-02  1.614E+00  1.334E+00;...
       2.00000E-02  7.779E-01  5.389E-01;...
       3.00000E-02  3.538E-01  1.537E-01;...
       4.00000E-02  2.485E-01  6.833E-02;...
       5.00000E-02  2.080E-01  4.098E-02;...
       6.00000E-02  1.875E-01  3.041E-02;...
       8.00000E-02  1.662E-01  2.407E-02;...
       1.00000E-01  1.541E-01  2.325E-02;...
       1.50000E-01  1.356E-01  2.496E-02;...
       2.00000E-01  1.233E-01  2.672E-02;...
       3.00000E-01  1.067E-01  2.872E-02;...
       4.00000E-01  9.549E-02  2.949E-02;...
       5.00000E-01  8.712E-02  2.966E-02;...
       6.00000E-01  8.055E-02  2.953E-02;...
       8.00000E-01  7.074E-02  2.882E-02;...
       1.00000E+00  6.358E-02  2.789E-02;...
       1.25000E+00  5.687E-02  2.666E-02;...
       1.50000E+00  5.175E-02  2.547E-02;...
       2.00000E+00  4.447E-02  2.345E-02;...
       3.00000E+00  3.581E-02  2.057E-02;...
       4.00000E+00  3.079E-02  1.870E-02;...
       5.00000E+00  2.751E-02  1.740E-02;...
       6.00000E+00  2.522E-02  1.647E-02;...
       8.00000E+00  2.225E-02  1.525E-02;...
       1.00000E+01  2.045E-02  1.450E-02;...
       1.50000E+01  1.810E-02  1.353E-02;...
       2.00000E+01  1.705E-02  1.311E-02];
   
 %% Return mu for given energy - nearest neighbor
%  [~,idx] = min(abs(energy-squeeze(muBT(:,1))));
%  muB = muBT(idx,2);
%  
%  [~,idx] = min(abs(energy-squeeze(muWT(:,1))));
%  muW = muWT(idx,2);
%  
%  [~,idx] = min(abs(energy-squeeze(muAT(:,1))));
%  muA = muAT(idx,2);
 
 %% Interpolate to the desired energy - spline
 x = squeeze(muBT(:,1));
 y = squeeze(muBT(:,2));
 muB = interp1(x,y,energy,'linear');
 
 x = squeeze(muWT(:,1));
 y = squeeze(muWT(:,2));
 muW = interp1(x,y,energy,'linear');
 
 x = squeeze(muAT(:,1));
 y = squeeze(muAT(:,2));
 muA = interp1(x,y,energy,'linear');
 
 % Convert to m^2/kg
muA = muA/1e1;
muW = muW/1e1;
muB = muB/1e1;